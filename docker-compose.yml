version: "3.3"
services:
  samba:
    image: dperson/samba:latest
    container_name: samba
    
    network_mode: "host"
    
    environment:
      # --- System Variables ---
      - USERID=${SAMBA_PUID}
      - GROUPID=${SAMBA_PGID}
      - TZ=${TZ}
    
    # dperson/samba configuration via command line arguments
    # -p: Set password authentication
    # -u "username;password": Add user
    # -s "name;path;browsable;readonly;guest;users": Add share
    command:
      - -p
      - -u
      - "${ADMIN_USER};${ADMIN_PASS}"
      - -u
      - "${GUEST_USER};${GUEST_PASS}"
      - -s
      - "${SHARE_1_NAME};${SHARE_1_PATH};yes;no;no;${SHARE_1_USERS}"
      - -s
      - "${SHARE_2_NAME};${SHARE_2_PATH};yes;no;no;${SHARE_2_USERS}"
    
    volumes:
      # V-1: Map Disk 1 (Shared) 
      - ${HOST_DISK_1_PATH}:${SHARE_1_PATH}:rw
      # V-2: Map Disk 2 (Private) 
      - ${HOST_DISK_2_PATH}:${SHARE_2_PATH}:rw
    
    restart: unless-stopped
